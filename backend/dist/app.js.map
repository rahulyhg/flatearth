{"version":3,"sources":["../src/app.js"],"names":["app","middlewares","readdirSync","__dirname","sort","forEach","middleware","use","require","default","server","createServer","callback","listen","err","Error","console","log"],"mappings":";;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;AACA;;AACA;;;;AAEA;;;;AACA;;;;AACA;;;;;;AAEA;;AAEA,MAAMA,MAAM,mBAAZ;AACA,MAAMC,cAAc,aAAGC,WAAH,CAAe,gBAAKC,SAAL,EAAgB,eAAhB,CAAf,EAAiDC,IAAjD,EAApB;;AAEAH,YAAYI,OAAZ,CAAoBC,cAAc;AAChC;AACAN,MAAIO,GAAJ,CAAQC,QAAS,iBAAgBF,UAAW,EAApC,EAAuCG,OAA/C;AACD,CAHD;;AAKAT,IAAIO,GAAJ,CAAQ,wBAAM,SAAN,uBAAR;;AAEA,MAAMG,SAAS,eAAKC,YAAL,CAAkBX,IAAIY,QAAJ,EAAlB,CAAf;;AAEA,yBAAUF,MAAV;AACAA,OAAOG,MAAP,eAAoBC,OAAO;AACzB,MAAIA,GAAJ,EAAS,MAAM,IAAIC,KAAJ,CAAUD,GAAV,CAAN;AACTE,UAAQC,GAAR,CAAY,yBAAZ;AACD,CAHD","file":"app.js","sourcesContent":["// @flow\nimport Koa from 'koa';\nimport fs from 'fs';\nimport http from 'http';\nimport url from 'url';\nimport { join } from 'path';\nimport { HOST, PORT } from 'config';\nimport mount from 'koa-mount';\n\nimport database from './libs/mongoose';\nimport APIModules from './modules/API-modules';\nimport webSocket from './services/websocket';\n\ndatabase();\n\nconst app = new Koa();\nconst middlewares = fs.readdirSync(join(__dirname, './middlewares')).sort();\n\nmiddlewares.forEach(middleware => {\n  // eslint-disable-next-line\n  app.use(require(`./middlewares/${middleware}`).default);\n});\n\napp.use(mount('/api/v1', APIModules));\n\nconst server = http.createServer(app.callback());\n\nwebSocket(server);\nserver.listen(PORT, err => {\n  if (err) throw new Error(err);\n  console.log('server running at %s:%s', HOST, PORT);\n});\n"]}